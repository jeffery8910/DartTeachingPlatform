<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dart ç¨‹å¼ç¢¼æ¨¡æ“¬å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            display: flex;
            flex-direction: column; /* Changed to column to stack nav and container */
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1.5rem;
        }
        .tab-nav-wrapper {
            max-width: 1024px; /* Match container width */
            width: 100%;
            margin-bottom: 1.5rem; /* Space between nav and container */
            background-color: #e2e8f0; /* Light gray for tab navigation */
            border-radius: 1.5rem; /* Rounded corners for the nav bar itself */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); /* Subtle shadow for nav */
            overflow: hidden; /* Ensure rounded corners clip content */
        }
        .tab-nav {
            padding: 0.75rem 0; /* Reduced padding slightly */
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            margin: 0.25rem;
            border-radius: 0.75rem;
            font-weight: 600;
            color: #4a5568; /* Dark gray text */
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: transparent;
            border: none;
        }
        .tab-button:hover {
            background-color: #cbd5e0;
            color: #2d3748;
        }
        .tab-button.active {
            background-color: #4c51bf; /* Indigo for active tab */
            color: white;
            box-shadow: 0 4px 10px rgba(76, 81, 191, 0.3);
        }

        .container {
            max-width: 1024px; /* Slightly wider to accommodate tabs */
            background-color: #ffffff;
            border-radius: 1.5rem; /* Apply full border-radius to the container */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            width: 100%; /* Ensure container takes full width */
        }
        @media (min-width: 768px) {
            .container {
                flex-direction: row;
            }
        }
        
        .tab-content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        @media (min-width: 768px) {
            .tab-content-wrapper {
                flex-direction: row;
            }
        }

        .tab-pane {
            display: none; /* Hide all tab panes by default */
        }
        .tab-pane.active {
            display: flex; /* Show active tab pane */
            flex-direction: column;
            flex: 1;
        }
        @media (min-width: 768px) {
            .tab-pane.active {
                flex-direction: row;
            }
        }

        .code-area, .output-area {
            flex: 1;
            padding: 2rem;
        }
        .code-area {
            background-color: #2d3748; /* Darker background for code input */
            color: #e2e8f0;
            font-family: 'Roboto Mono', monospace; /* Monospaced font for code */
            font-size: 0.95rem;
            line-height: 1.5;
            border-bottom-left-radius: 1.5rem; /* Apply bottom-left radius */
        }
        @media (min-width: 768px) {
            .code-area {
                border-top-left-radius: 1.5rem; /* Apply top-left radius on desktop */
                border-bottom-left-radius: 1.5rem; /* Ensure bottom-left is also rounded */
            }
        }
        @media (max-width: 767px) {
            .code-area {
                border-bottom-left-radius: 0; /* No bottom-left on mobile */
                border-top-right-radius: 1.5rem; /* Top-right on mobile */
            }
        }
        .output-area {
            background-color: #f7fafc; /* Lighter background for output */
            color: #2d3748;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            border-bottom-right-radius: 1.5rem; /* Apply bottom-right radius */
        }
        @media (min-width: 768px) {
            .output-area {
                border-top-right-radius: 1.5rem; /* Apply top-right radius on desktop */
                border-bottom-right-radius: 1.5rem; /* Ensure bottom-right is also rounded */
            }
        }
        @media (max-width: 767px) {
            .output-area {
                border-top-right-radius: 0; /* No top-right on mobile */
                border-bottom-left-radius: 1.5rem; /* Bottom-left on mobile */
            }
        }
        textarea {
            background-color: transparent;
            border: none;
            resize: none;
            outline: none;
            width: 100%;
            height: 250px; /* Fixed height for code input */
            padding: 0.5rem;
            color: #e2e8f0;
        }
        pre {
            white-space: pre-wrap; /* Preserve whitespace and wrap long lines */
            word-break: break-word; /* Break long words */
            min-height: 250px; /* Fixed height for output */
            padding: 0.5rem;
            background-color: #e2e8f0; /* Slightly darker background for output content */
            border-radius: 0.5rem;
            color: #1a202c;
        }
        .btn-run {
            background-image: linear-gradient(to right, #4c51bf 0%, #667eea 100%); /* Gradient button */
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 81, 191, 0.4);
        }
        .btn-run:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(76, 81, 191, 0.6);
        }
        .info-box {
            background-color: #e0f2fe; /* Light blue info box */
            color: #2563eb;
            border: 1px solid #93c5fd;
        }
    </style>
</head>
<body>
    <div class="tab-nav-wrapper">
        <div class="tab-nav">
            <button class="tab-button active" data-tab="unit1">å–®å…ƒ 1: è®Šæ•¸èˆ‡è¼¸å‡º</button>
            <button class="tab-button" data-tab="unit2">å–®å…ƒ 2: æ¢ä»¶èªå¥</button>
            <button class="tab-button" data-tab="unit3">å–®å…ƒ 3: è¿´åœˆ</button>
            <button class="tab-button" data-tab="unit4">å–®å…ƒ 4: å‡½æ•¸</button>
        </div>
    </div>

    <div class="container">
        <div class="tab-content-wrapper">
            <div id="unit1" class="tab-pane active">
                <div class="code-area">
                    <h2 class="text-3xl font-bold mb-6 text-white">Dart ç¨‹å¼ç¢¼è¼¸å…¥</h2>
                    <div class="info-box p-4 rounded-lg mb-6 text-sm">
                        <p class="font-semibold mb-2">ğŸ’¡ æç¤ºï¼š</p>
                        <p>æœ¬å–®å…ƒå°ˆæ³¨æ–¼ Dart çš„è®Šæ•¸å®£å‘Š (`var`, `int`, `String`, `bool`, `double`) å’Œ `print()` è¼¸å‡ºã€‚</p>
                        <ul class="list-disc list-inside mt-2">
                            <li>`print('æ‚¨çš„è¨Šæ¯');` æˆ– `print("æ‚¨çš„è¨Šæ¯");`</li>
                            <li>`var è®Šæ•¸å = 'å€¼';`</li>
                            <li>`int è®Šæ•¸å = æ•¸å­—;`</li>
                            <li>`double è®Šæ•¸å = æ•¸å­—;`</li>
                            <li>`bool è®Šæ•¸å = true/false;`</li>
                            <li>æ”¯æ´å­—ä¸²æ’å€¼ï¼š`'å“ˆå›‰, $nameï¼'`</li>
                        </ul>
                        <p class="mt-2">è«‹æ³¨æ„ï¼Œé€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„æ¨¡æ“¬å™¨ï¼Œä¸æ”¯æ´å®Œæ•´çš„ Dart èªæ³•è§£ææˆ–è¤‡é›œé‚è¼¯ã€‚</p>
                    </div>
                    <textarea id="dartCodeInput1" placeholder="è¼¸å…¥æ‚¨çš„ Dart ç¨‹å¼ç¢¼ç‰‡æ®µ">
void main() {
  // å®£å‘Šä¸åŒå‹åˆ¥çš„è®Šæ•¸
  var name = 'å·¥ç¨‹å¸«';
  String greeting = "å“ˆå›‰";
  int year = 2025;
  double price = 99.99;
  bool isActive = true;

  // ä½¿ç”¨ print å‡½æ•¸è¼¸å‡ºè®Šæ•¸å’Œå­—ä¸²æ’å€¼
  print('$greeting, $nameï¼');
  print('ç¾åœ¨æ˜¯ $year å¹´ã€‚');
  print('å•†å“åƒ¹æ ¼: \\$\\{price\\}ã€‚'); // FIX: Escape $ and {} for JavaScript template literal
  print('ç‹€æ…‹æ´»èº: $isActive');

  // æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥è¼¸å‡ºæ–‡å­—
  print('é€™æ˜¯ä¸€å€‹ç›´æ¥çš„è¨Šæ¯ã€‚');
}
</textarea>
                    <button class="btn-run w-full text-white font-bold py-3 px-6 rounded-xl mt-6 text-lg" data-target-input="dartCodeInput1" data-target-output="dartOutput1">
                        åŸ·è¡Œ Dart ç¨‹å¼ç¢¼
                    </button>
                </div>
                <div class="output-area">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">æ¨¡æ“¬è¼¸å‡º</h2>
                    <pre id="dartOutput1" class="rounded-lg p-4 text-gray-800 border border-gray-300">
                        é»æ“Šã€ŒåŸ·è¡Œ Dart ç¨‹å¼ç¢¼ã€æŒ‰éˆ•æŸ¥çœ‹è¼¸å‡ºã€‚
                    </pre>
                </div>
            </div>

            <div id="unit2" class="tab-pane">
                <div class="code-area">
                    <h2 class="text-3xl font-bold mb-6 text-white">Dart ç¨‹å¼ç¢¼è¼¸å…¥</h2>
                    <div class="info-box p-4 rounded-lg mb-6 text-sm">
                        <p class="font-semibold mb-2">ğŸ’¡ æç¤ºï¼š</p>
                        <p>æœ¬å–®å…ƒå°ˆæ³¨æ–¼ Dart çš„æ¢ä»¶èªå¥ (`if`, `else if`, `else`)ã€‚</p>
                        <ul class="list-disc list-inside mt-2">
                            <li>æ¨¡æ“¬å™¨æœƒå˜—è©¦åˆ¤æ–·ç°¡å–®çš„å¸ƒæ—æ¢ä»¶ (`true`, `false`)ã€‚</li>
                            <li>è®Šæ•¸æ¯”è¼ƒï¼ˆå¦‚ `age > 18`ï¼‰ç›®å‰ä¸æ”¯æ´ï¼Œè«‹ç›´æ¥ä½¿ç”¨ `true` æˆ– `false` é€²è¡Œæ¸¬è©¦ã€‚</li>
                        </ul>
                        <p class="mt-2">è«‹æ³¨æ„ï¼Œé€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„æ¨¡æ“¬å™¨ï¼Œä¸æ”¯æ´å®Œæ•´çš„ Dart èªæ³•è§£ææˆ–è¤‡é›œé‚è¼¯ã€‚</p>
                    </div>
                    <textarea id="dartCodeInput2" placeholder="è¼¸å…¥æ‚¨çš„ Dart ç¨‹å¼ç¢¼ç‰‡æ®µ">
void main() {
  var isRaining = true; // å˜—è©¦æ”¹ç‚º false çœ‹çœ‹
  var temperature = 25; // æ¨¡æ“¬å™¨ç›®å‰ä¸è™•ç†æ•¸å€¼æ¯”è¼ƒ

  if (isRaining) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–· isRaining çš„å¸ƒæ—å€¼
    print('å¤–é¢æ­£åœ¨ä¸‹é›¨ï¼Œè¨˜å¾—å¸¶å‚˜ï¼');
  } else {
    print('å¤©æ°£æ™´æœ—ï¼Œé©åˆå‡ºé–€ã€‚');
  }

  // æ¨¡æ“¬å¤šé‡æ¢ä»¶ (è«‹ç›´æ¥ä½¿ç”¨ true/false æ¸¬è©¦)
  if (true) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–·æ­¤ç‚º true
    print('é€™æ˜¯ç¬¬ä¸€å€‹æ¢ä»¶ã€‚');
  } else if (false) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–·æ­¤ç‚º false
    print('é€™æ˜¯ç¬¬äºŒå€‹æ¢ä»¶ã€‚');
  } else {
    print('æ²’æœ‰æ¢ä»¶ç¬¦åˆã€‚');
  }
}
</textarea>
                    <button class="btn-run w-full text-white font-bold py-3 px-6 rounded-xl mt-6 text-lg" data-target-input="dartCodeInput2" data-target-output="dartOutput2">
                        åŸ·è¡Œ Dart ç¨‹å¼ç¢¼
                    </button>
                </div>
                <div class="output-area">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">æ¨¡æ“¬è¼¸å‡º</h2>
                    <pre id="dartOutput2" class="rounded-lg p-4 text-gray-800 border border-gray-300">
                        é»æ“Šã€ŒåŸ·è¡Œ Dart ç¨‹å¼ç¢¼ã€æŒ‰éˆ•æŸ¥çœ‹è¼¸å‡ºã€‚
                    </pre>
                </div>
            </div>

            <div id="unit3" class="tab-pane">
                <div class="code-area">
                    <h2 class="text-3xl font-bold mb-6 text-white">Dart ç¨‹å¼ç¢¼è¼¸å…¥</h2>
                    <div class="info-box p-4 rounded-lg mb-6 text-sm">
                        <p class="font-semibold mb-2">ğŸ’¡ æç¤ºï¼š</p>
                        <p>æœ¬å–®å…ƒå°ˆæ³¨æ–¼ Dart çš„è¿´åœˆ (`for`, `while`)ã€‚</p>
                        <ul class="list-disc list-inside mt-2">
                            <li>æ¨¡æ“¬å™¨æœƒè­˜åˆ¥ `for` å’Œ `while` è¿´åœˆçš„èªæ³•ã€‚</li>
                            <li>å°æ–¼ `for` è¿´åœˆï¼Œæœƒæ¨¡æ“¬åŸ·è¡Œ `print` èªå¥ï¼Œä½†è¿´åœˆæ¬¡æ•¸æœƒè¢«é™åˆ¶ä»¥é¿å…ç„¡é™è¿´åœˆã€‚</li>
                            <li>å°æ–¼ `while` è¿´åœˆï¼Œåƒ…æ¨¡æ“¬å…¶å­˜åœ¨ã€‚</li>
                        </ul>
                        <p class="mt-2">è«‹æ³¨æ„ï¼Œé€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„æ¨¡æ“¬å™¨ï¼Œä¸æ”¯æ´å®Œæ•´çš„ Dart èªæ³•è§£ææˆ–è¤‡é›œé‚è¼¯ã€‚</p>
                    </div>
                    <textarea id="dartCodeInput3" placeholder="è¼¸å…¥æ‚¨çš„ Dart ç¨‹å¼ç¢¼ç‰‡æ®µ">
void main() {
  // for è¿´åœˆç¯„ä¾‹
  print('--- for è¿´åœˆé–‹å§‹ ---');
  for (int i = 0; i < 3; i++) { // æ¨¡æ“¬å™¨æœƒåŸ·è¡Œ 3 æ¬¡
    print('for è¿´åœˆè¨ˆæ•¸: $i');
  }
  print('--- for è¿´åœˆçµæŸ ---');

  // while è¿´åœˆç¯„ä¾‹
  print('\n--- while è¿´åœˆé–‹å§‹ ---');
  int count = 0;
  while (count < 2) { // æ¨¡æ“¬å™¨æœƒåŸ·è¡Œ 2 æ¬¡
    print('while è¿´åœˆè¨ˆæ•¸: $count');
    count++;
  }
  print('--- while è¿´åœˆçµæŸ ---');

  // éæ­·åˆ—è¡¨ (for-in è¿´åœˆ)
  print('\n--- éæ­·åˆ—è¡¨ ---');
  List<String> fruits = ['è˜‹æœ', 'é¦™è•‰', 'æ©˜å­'];
  for (var fruit in fruits) {
    print('æ°´æœ: $fruit');
  }
}
</textarea>
                    <button class="btn-run w-full text-white font-bold py-3 px-6 rounded-xl mt-6 text-lg" data-target-input="dartCodeInput3" data-target-output="dartOutput3">
                        åŸ·è¡Œ Dart ç¨‹å¼ç¢¼
                    </button>
                </div>
                <div class="output-area">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">æ¨¡æ“¬è¼¸å‡º</h2>
                    <pre id="dartOutput3" class="rounded-lg p-4 text-gray-800 border border-gray-300">
                        é»æ“Šã€ŒåŸ·è¡Œ Dart ç¨‹å¼ç¢¼ã€æŒ‰éˆ•æŸ¥çœ‹è¼¸å‡ºã€‚
                    </pre>
                </div>
            </div>

            <div id="unit4" class="tab-pane">
                <div class="code-area">
                    <h2 class="text-3xl font-bold mb-6 text-white">Dart ç¨‹å¼ç¢¼è¼¸å…¥</h2>
                    <div class="info-box p-4 rounded-lg mb-6 text-sm">
                        <p class="font-semibold mb-2">ğŸ’¡ æç¤ºï¼š</p>
                        <p>æœ¬å–®å…ƒå°ˆæ³¨æ–¼ Dart çš„å‡½æ•¸å®šç¾©èˆ‡å‘¼å«ã€‚</p>
                        <ul class="list-disc list-inside mt-2">
                            <li>æ¨¡æ“¬å™¨å¯ä»¥è­˜åˆ¥ç°¡å–®çš„å‡½æ•¸å®šç¾©å’Œ `print()` èªå¥ã€‚</li>
                            <li>å‡½æ•¸çš„åƒæ•¸å’Œå›å‚³å€¼ç›®å‰ä¸æ”¯æ´è¤‡é›œçš„é‹ç®—ã€‚</li>
                        </ul>
                        <p class="mt-2">è«‹æ³¨æ„ï¼Œé€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„æ¨¡æ“¬å™¨ï¼Œä¸æ”¯æ´å®Œæ•´çš„ Dart èªæ³•è§£ææˆ–è¤‡é›œé‚è¼¯ã€‚</p>
                    </div>
                    <textarea id="dartCodeInput4" placeholder="è¼¸å…¥æ‚¨çš„ Dart ç¨‹å¼ç¢¼ç‰‡æ®µ">
// å®šç¾©ä¸€å€‹æ²’æœ‰å›å‚³å€¼çš„å‡½æ•¸
void greet(String name) {
  print('å“ˆå›‰, $nameï¼æ­¡è¿ä¾†åˆ° Dart ä¸–ç•Œã€‚');
}

// å®šç¾©ä¸€å€‹æœ‰å›å‚³å€¼çš„å‡½æ•¸
String createMessage(String item) {
  return 'æ‚¨é¸æ“‡äº†: $item';
}

void main() {
  // å‘¼å«å‡½æ•¸
  greet('å°æ˜');

  // å‘¼å«æœ‰å›å‚³å€¼çš„å‡½æ•¸ä¸¦è¼¸å‡ºçµæœ
  var myChoice = createMessage('è˜‹æœ');
  print(myChoice);

  // åŒ¿åå‡½æ•¸ (æ¨¡æ“¬å™¨ä¸åŸ·è¡Œå…¶å…§éƒ¨é‚è¼¯ï¼Œåƒ…è­˜åˆ¥èªæ³•)
  var sayHello = () {
    print('é€™æ˜¯ä¸€å€‹åŒ¿åå‡½æ•¸ã€‚');
  };
  sayHello(); // å‘¼å«åŒ¿åå‡½æ•¸
}
</textarea>
                    <button class="btn-run w-full text-white font-bold py-3 px-6 rounded-xl mt-6 text-lg" data-target-input="dartCodeInput4" data-target-output="dartOutput4">
                        åŸ·è¡Œ Dart ç¨‹å¼ç¢¼
                    </button>
                </div>
                <div class="output-area">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">æ¨¡æ“¬è¼¸å‡º</h2>
                    <pre id="dartOutput4" class="rounded-lg p-4 text-gray-800 border border-gray-300">
                        é»æ“Šã€ŒåŸ·è¡Œ Dart ç¨‹å¼ç¢¼ã€æŒ‰éˆ•æŸ¥çœ‹è¼¸å‡ºã€‚
                    </pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanes = document.querySelectorAll('.tab-pane');

            // é è¨­çš„ Dart ç¨‹å¼ç¢¼ç¯„ä¾‹
            const defaultCodeExamples = {
                unit1: `void main() {
  // å®£å‘Šä¸åŒå‹åˆ¥çš„è®Šæ•¸
  var name = 'å·¥ç¨‹å¸«';
  String greeting = "å“ˆå›‰";
  int year = 2025;
  double price = 99.99;
  bool isActive = true;

  // ä½¿ç”¨ print å‡½æ•¸è¼¸å‡ºè®Šæ•¸å’Œå­—ä¸²æ’å€¼
  print('$greeting, $nameï¼');
  print('ç¾åœ¨æ˜¯ $year å¹´ã€‚');
  print('å•†å“åƒ¹æ ¼: \\$\\{price\\}ã€‚'); // FIX: Escape $ and {} for JavaScript template literal
  print('ç‹€æ…‹æ´»èº: $isActive');

  // æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥è¼¸å‡ºæ–‡å­—
  print('é€™æ˜¯ä¸€å€‹ç›´æ¥çš„è¨Šæ¯ã€‚');
}`,
                unit2: `void main() {
  var isRaining = true; // å˜—è©¦æ”¹ç‚º false çœ‹çœ‹
  var temperature = 25; // æ¨¡æ“¬å™¨ç›®å‰ä¸è™•ç†æ•¸å€¼æ¯”è¼ƒ

  if (isRaining) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–· isRaining çš„å¸ƒæ—å€¼
    print('å¤–é¢æ­£åœ¨ä¸‹é›¨ï¼Œè¨˜å¾—å¸¶å‚˜ï¼');
  } else {
    print('å¤©æ°£æ™´æœ—ï¼Œé©åˆå‡ºé–€ã€‚');
  }

  // æ¨¡æ“¬å¤šé‡æ¢ä»¶ (è«‹ç›´æ¥ä½¿ç”¨ true/false æ¸¬è©¦)
  if (true) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–·æ­¤ç‚º true
    print('é€™æ˜¯ç¬¬ä¸€å€‹æ¢ä»¶ã€‚');
  } else if (false) { // æ¨¡æ“¬å™¨æœƒåˆ¤æ–·æ­¤ç‚º false
    print('é€™æ˜¯ç¬¬äºŒå€‹æ¢ä»¶ã€‚');
  } else {
    print('æ²’æœ‰æ¢ä»¶ç¬¦åˆã€‚');
  }
}`,
                unit3: `void main() {
  // for è¿´åœˆç¯„ä¾‹
  print('--- for è¿´åœˆé–‹å§‹ ---');
  for (int i = 0; i < 3; i++) { // æ¨¡æ“¬å™¨æœƒåŸ·è¡Œ 3 æ¬¡
    print('for è¿´åœˆè¨ˆæ•¸: $i');
  }
  print('--- for è¿´åœˆçµæŸ ---');

  // while è¿´åœˆç¯„ä¾‹
  print('\\n--- while è¿´åœˆé–‹å§‹ ---');
  int count = 0;
  while (count < 2) { // æ¨¡æ“¬å™¨æœƒåŸ·è¡Œ 2 æ¬¡
    print('while è¿´åœˆè¨ˆæ•¸: $count');
    count++;
  }
  print('--- while è¿´åœˆçµæŸ ---');

  // éæ­·åˆ—è¡¨ (for-in è¿´åœˆ)
  print('\\n--- éæ­·åˆ—è¡¨ ---');
  List<String> fruits = ['è˜‹æœ', 'é¦™è•‰', 'æ©˜å­'];
  for (var fruit in fruits) {
    print('æ°´æœ: $fruit');
  }
}`,
                unit4: `// å®šç¾©ä¸€å€‹æ²’æœ‰å›å‚³å€¼çš„å‡½æ•¸
void greet(String name) {
  print('å“ˆå›‰, $nameï¼æ­¡è¿ä¾†åˆ° Dart ä¸–ç•Œã€‚');
}

// å®šç¾©ä¸€å€‹æœ‰å›å‚³å€¼çš„å‡½æ•¸
String createMessage(String item) {
  return 'æ‚¨é¸æ“‡äº†: $item';
}

void main() {
  // å‘¼å«å‡½æ•¸
  greet('å°æ˜');

  // å‘¼å«æœ‰å›å‚³å€¼çš„å‡½æ•¸ä¸¦è¼¸å‡ºçµæœ
  var myChoice = createMessage('è˜‹æœ');
  print(myChoice);

  // åŒ¿åå‡½æ•¸ (æ¨¡æ“¬å™¨ä¸åŸ·è¡Œå…¶å…§éƒ¨é‚è¼¯ï¼Œåƒ…è­˜åˆ¥èªæ³•)
  var sayHello = () {
    print('é€™æ˜¯ä¸€å€‹åŒ¿åå‡½æ•¸ã€‚');
  };
  sayHello(); // å‘¼å«åŒ¿åå‡½æ•¸
}`
            };

            // æ¨¡æ“¬ Dart ç¨‹å¼ç¢¼åŸ·è¡Œé‚è¼¯
            function simulateDartCode(code) {
                const lines = code.split('\n');
                let output = [];
                let variables = {}; // æ¨¡æ“¬ç°¡å–®çš„è®Šæ•¸å„²å­˜

                // Function to process a block of lines (e.g., inside main, if, for)
                const processBlock = (blockLines) => {
                    let blockOutput = [];
                    blockLines.forEach(line => {
                        line = line.trim();

                        // Simulate print() statement
                        const printMatch = line.match(/print\((['"])(.*?)\1\);/); // Capture content inside quotes
                        if (printMatch) {
                            let messageContent = printMatch[2]; // Get the content inside the quotes

                            // Handle escaped dollar signs first: \$ -> $
                            messageContent = messageContent.replace(/\\\$/g, '$');

                            // Handle Dart string interpolation: ${expression}
                            messageContent = messageContent.replace(/\$\{(\w+)\}/g, (match, varName) => {
                                return variables[varName] !== undefined ? variables[varName] : match;
                            });
                            // Handle Dart string interpolation: $variable
                            messageContent = messageContent.replace(/\$(\w+)/g, (match, varName) => {
                                return variables[varName] !== undefined ? variables[varName] : match;
                            });

                            blockOutput.push(messageContent);
                            return;
                        }

                        // Simulate variable declaration (var, int, String, bool, double)
                        const varMatch = line.match(/(var|int|String|bool|double)\s+(\w+)\s*=\s*(.+?);/);
                        if (varMatch) {
                            const type = varMatch[1];
                            const varName = varMatch[2];
                            let varValue = varMatch[3];

                            // Attempt to parse value
                            if (varValue.startsWith("'") || varValue.startsWith('"')) {
                                varValue = varValue.substring(1, varValue.length - 1); // Remove quotes
                            } else if (varValue === 'true' || varValue === 'false') {
                                varValue = (varValue === 'true');
                            } else if (!isNaN(parseFloat(varValue))) {
                                varValue = parseFloat(varValue);
                            }
                            variables[varName] = varValue;
                            blockOutput.push(`(æ¨¡æ“¬) å®£å‘Šäº† ${type} è®Šæ•¸: ${varName} = ${varValue}`);
                            return;
                        }

                        // Simulate if/else statement (very simplified, only checks boolean literals)
                        const ifMatch = line.match(/if\s*\((true|false)\)\s*\{/);
                        if (ifMatch) {
                            const condition = ifMatch[1] === 'true';
                            let blockContent = [];
                            let i = lines.indexOf(line) + 1;
                            let braceCount = 1;
                            while (i < lines.length && braceCount > 0) {
                                const currentLine = lines[i].trim();
                                if (currentLine === '{') braceCount++;
                                if (currentLine === '}') braceCount--;
                                if (braceCount > 0) blockContent.push(currentLine);
                                i++;
                            }

                            if (condition) {
                                blockOutput.push(`(æ¨¡æ“¬) é€²å…¥ if å€å¡Š (æ¢ä»¶ç‚ºçœŸ)`);
                                blockOutput.push(...processBlock(blockContent)); // Recursive call for inner block
                            } else {
                                // Check for else
                                const elseMatch = lines[i]?.trim().match(/else\s*\{/);
                                if (elseMatch) {
                                    blockOutput.push(`(æ¨¡æ“¬) é€²å…¥ else å€å¡Š (æ¢ä»¶ç‚ºå‡)`);
                                    let elseBlockContent = [];
                                    i++; // Skip else {
                                    braceCount = 1;
                                    while (i < lines.length && braceCount > 0) {
                                        const currentLine = lines[i].trim();
                                        if (currentLine === '{') braceCount++;
                                        if (currentLine === '}') braceCount--;
                                        if (braceCount > 0) elseBlockContent.push(currentLine);
                                        i++;
                                    }
                                    blockOutput.push(...processBlock(elseBlockContent)); // Recursive call for inner block
                                } else {
                                    blockOutput.push(`(æ¨¡æ“¬) if æ¢ä»¶ç‚ºå‡ï¼Œè·³é if å€å¡Š`);
                                }
                            }
                            return;
                        }

                        // Simulate for loop (very simplified, only executes print statements a fixed number of times)
                        const forMatch = line.match(/for\s*\((.+?)\s*;\s*(.+?)\s*;\s*(.+?)\)\s*\{/);
                        if (forMatch) {
                            blockOutput.push(`(æ¨¡æ“¬) è­˜åˆ¥åˆ° for è¿´åœˆã€‚`);
                            let blockContent = [];
                            let i = lines.indexOf(line) + 1;
                            let braceCount = 1;
                            while (i < lines.length && braceCount > 0) {
                                const currentLine = lines[i].trim();
                                if (currentLine === '{') braceCount++;
                                if (currentLine === '}') braceCount--;
                                if (braceCount > 0) blockContent.push(currentLine);
                                i++;
                            }
                            const simulatedInnerOutput = processBlock(blockContent); // Recursive call for inner block
                            for (let j = 0; j < 3; j++) { // Simulate 3 iterations
                                blockOutput.push(`(æ¨¡æ“¬) è¿´åœˆè¿­ä»£ ${j + 1}:`);
                                blockOutput.push(...simulatedInnerOutput);
                            }
                            blockOutput.push(`(æ¨¡æ“¬) for è¿´åœˆæ¨¡æ“¬çµæŸã€‚`);
                            return;
                        }

                        // Simulate while loop (very simplified, only executes print statements a fixed number of times)
                        const whileMatch = line.match(/while\s*\((.+?)\)\s*\{/);
                        if (whileMatch) {
                            blockOutput.push(`(æ¨¡æ“¬) è­˜åˆ¥åˆ° while è¿´åœˆã€‚`);
                            let blockContent = [];
                            let i = lines.indexOf(line) + 1;
                            let braceCount = 1;
                            while (i < lines.length && braceCount > 0) {
                                const currentLine = lines[i].trim();
                                if (currentLine === '{') braceCount++;
                                if (currentLine === '}') braceCount--;
                                if (braceCount > 0) blockContent.push(currentLine);
                                i++;
                            }
                            const simulatedInnerOutput = processBlock(blockContent); // Recursive call for inner block
                            for (let j = 0; j < 2; j++) { // Simulate 2 iterations
                                blockOutput.push(`(æ¨¡æ“¬) è¿´åœˆè¿­ä»£ ${j + 1}:`);
                                blockOutput.push(...simulatedInnerOutput);
                            }
                            blockOutput.push(`(æ¨¡æ“¬) while è¿´åœˆæ¨¡æ“¬çµæŸã€‚`);
                            return;
                        }

                        // Simulate function call (very simplified, only recognizes function name and arguments)
                        const functionCallMatch = line.match(/(\w+)\s*\((.*?)\);/);
                        if (functionCallMatch) {
                            const funcName = functionCallMatch[1];
                            const args = functionCallMatch[2];
                            blockOutput.push(`(æ¨¡æ“¬) å‘¼å«å‡½æ•¸: ${funcName}(${args})`);
                            if (funcName === 'createMessage') {
                                const argValue = args.replace(/['"]/g, '');
                                blockOutput.push(`(æ¨¡æ“¬) å‡½æ•¸å›å‚³: æ‚¨é¸æ“‡äº†: ${argValue}`);
                            }
                            if (funcName === 'greet') {
                                 const argValue = args.replace(/['"]/g, '');
                                 blockOutput.push(`å“ˆå›‰, ${argValue}ï¼æ­¡è¿ä¾†åˆ° Dart ä¸–ç•Œã€‚`);
                            }
                            if (funcName === 'sayHello') {
                                blockOutput.push(`é€™æ˜¯ä¸€å€‹åŒ¿åå‡½æ•¸ã€‚`);
                            }
                            return;
                        }

                        // If empty line or comment, skip
                        if (line === '' || line.startsWith('//') || line.startsWith('/*')) {
                            return;
                        }

                        // For unrecognized syntax, provide a hint
                        if (line.length > 0) {
                            blockOutput.push(`(æ¨¡æ“¬) æœªè­˜åˆ¥çš„èªæ³•æˆ–å·²è·³é: ${line}`);
                        }
                    });
                    return blockOutput;
                };

                let mainContent = [];
                let inMainBlock = false;
                let braceLevel = 0;

                lines.forEach(line => {
                    if (line.includes('void main() {')) {
                        inMainBlock = true;
                        braceLevel++;
                        return; // Skip the main function declaration line itself
                    }
                    if (inMainBlock) {
                        if (line.includes('{')) {
                            braceLevel++;
                        }
                        if (line.includes('}')) {
                            braceLevel--;
                        }
                        if (braceLevel === 0 && line.includes('}')) { // End of main function
                            inMainBlock = false;
                            return;
                        }
                        if (inMainBlock) { // Only add lines if still inside main
                           mainContent.push(line);
                        }
                    }
                });

                // Process the main function content
                const finalOutput = processBlock(mainContent);

                if (finalOutput.length === 0) {
                    return "æ²’æœ‰å¯æ¨¡æ“¬çš„ Dart è¼¸å‡ºã€‚è«‹å˜—è©¦è¼¸å…¥ `print('Hello');` æˆ–è®Šæ•¸å®£å‘Šã€‚";
                }
                return finalOutput.join('\n');
            }

            // Tab åˆ‡æ›é‚è¼¯
            function showTab(tabId) {
                tabPanes.forEach(pane => {
                    pane.classList.remove('active');
                });
                tabButtons.forEach(button => {
                    button.classList.remove('active');
                });

                document.getElementById(tabId).classList.add('active');
                document.querySelector(`.tab-button[data-tab="${tabId}"]`).classList.add('active');

                // è¼‰å…¥è©²å–®å…ƒçš„é è¨­ç¨‹å¼ç¢¼ä¸¦åŸ·è¡Œ
                const inputId = `dartCodeInput${tabId.replace('unit', '')}`;
                const outputId = `dartOutput${tabId.replace('unit', '')}`;
                const currentInput = document.getElementById(inputId);
                const currentOutput = document.getElementById(outputId);

                if (currentInput) {
                    currentInput.value = defaultCodeExamples[tabId];
                    // è‡ªå‹•åŸ·è¡Œä¸€æ¬¡ç¨‹å¼ç¢¼
                    const simulatedOutput = simulateDartCode(currentInput.value);
                    currentOutput.textContent = simulatedOutput;
                }
            }

            // ç‚ºæ¯å€‹ Tab æŒ‰éˆ•æ·»åŠ äº‹ä»¶ç›£è½å™¨
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;
                    showTab(tabId);
                });
            });

            // ç‚ºæ¯å€‹ã€ŒåŸ·è¡Œ Dart ç¨‹å¼ç¢¼ã€æŒ‰éˆ•æ·»åŠ äº‹ä»¶ç›£è½å™¨
            document.querySelectorAll('.btn-run').forEach(button => {
                button.addEventListener('click', (event) => {
                    const targetInputId = event.target.dataset.targetInput;
                    const targetOutputId = event.target.dataset.targetOutput;
                    const code = document.getElementById(targetInputId).value;
                    const simulatedOutput = simulateDartCode(code);
                    document.getElementById(targetOutputId).textContent = simulatedOutput;
                });
            });

            // é è¨­é¡¯ç¤ºç¬¬ä¸€å€‹å–®å…ƒ
            showTab('unit1');
        });
    </script>
</body>
</html>
